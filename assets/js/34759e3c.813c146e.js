"use strict";(self.webpackChunkjosp_docs=self.webpackChunkjosp_docs||[]).push([[4391],{80370:(e,t,s)=>{s.r(t),s.d(t,{assets:()=>c,contentTitle:()=>o,default:()=>m,frontMatter:()=>l,metadata:()=>r,toc:()=>p});var n=s(87462),a=(s(67294),s(3905)),i=s(26113);const l={title:"Protocol"},o="JOSP Protocol",r={unversionedId:"josp/specs/protocol",id:"josp/specs/protocol",title:"Protocol",description:"<WhatIntro",source:"@site/1_what/2_josp/30_specs/31_protocol.mdx",sourceDirName:"2_josp/30_specs",slug:"/josp/specs/protocol",permalink:"/what/josp/specs/protocol",draft:!1,tags:[],version:"current",sidebarPosition:31,frontMatter:{title:"Protocol"},sidebar:"docsSidebar",previous:{title:"Admin",permalink:"/what/josp/actors/admin"},next:{title:"Communication",permalink:"/what/josp/specs/comm"}},c={},p=[{value:"Object Presentation",id:"object-presentation",level:2},{value:"Status Update",id:"status-update",level:2},{value:"Action Request",id:"action-request",level:2},{value:"Object Setters",id:"object-setters",level:2},{value:"Object Permissions Editing",id:"object-permissions-editing",level:2},{value:"Object History Requests",id:"object-history-requests",level:2},{value:"JCP Gateway messages",id:"jcp-gateway-messages",level:2}],u={toc:p},d="wrapper";function m(e){let{components:t,...s}=e;return(0,a.kt)(d,(0,n.Z)({},u,s,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"josp-protocol"},"JOSP Protocol"),(0,a.kt)(i.ZP,{logo_path:"/img/logo/logo_text_250.png",mdxType:"WhatIntro"},(0,a.kt)("p",null,"The JOSP protocol is the language used by JOSP Objects and JOSP Services to communicate with each other.",(0,a.kt)("br",null),"\nThis protocol is used in both communication types (direct and cloud) supported by a JOSP EcoSystem.")),(0,a.kt)("br",null),(0,a.kt)("p",null,"With this protocol JOSP Objects can send their info and structure to JOSP Services.\nThey can also inform services when an objet's state change his value.",(0,a.kt)("br",null),"\nOn the other side, JOSP Services use this protocol to send request to object for commands execution or update object's configs."),(0,a.kt)("p",null,"The JOSP protocol, as a result of having applied the ",(0,a.kt)("strong",{parentName:"p"},"Security-by-design")," concept during the JOSP EcoSystem design, provides fields related to the system security.\nEach message from a JOSP Object contains his id, like each message from a JOSP Service contains service and user ids.\nThat plus the use of ",(0,a.kt)("strong",{parentName:"p"},"encrypted communication channels")," with SSL certificates, prevents services change their identity after the connection has been established."),(0,a.kt)("hr",null),(0,a.kt)("h2",{id:"object-presentation"},"Object Presentation"),(0,a.kt)("p",null,"Objects presentation is a set of JOSP ",(0,a.kt)("strong",{parentName:"p"},"messages used by objects to present themselves to other JOSP Services and to the JCP Gateway"),"."),(0,a.kt)("p",null,"When a JOSP Object opens a new connection (to a JOSP Service or to the JCP Gateway), it sends following messages:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"OBJ_INF_MSG")," a message that contains object's info like id, name, model, description..."),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"OBJ_STRUCT_MSG")," a message that contains object's structure, this structure is an altered version of the structure defined by Makers."),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"OBJ_PERMS_MSG")," a message that contains object's permissions list.")),(0,a.kt)("p",null,"Those messages are always send to the JCP Gateway, meanwhile objects send those messages only to services with at least the STATE access level.\nThe ",(0,a.kt)("inlineCode",{parentName:"p"},"OBJ_PERMS_MSG")," message is sent only to JOSP Services with the OWNER access level."),(0,a.kt)("p",null,"Only when the remote peer of the new connection is a JOSP Services, the object calculate from his permission list the service/user access level.\nThen the object sent the ",(0,a.kt)("inlineCode",{parentName:"p"},"SRV_PERMS_MSG")," message that inform the service of what level of access they have been granted."),(0,a.kt)("hr",null),(0,a.kt)("h2",{id:"status-update"},"Status Update"),(0,a.kt)("p",null,"OBJ > SRV"),(0,a.kt)("p",null,"Every time a JOSP Object must inform JOSP Services for a state update, it sent a ",(0,a.kt)("inlineCode",{parentName:"p"},"UPD_MSG")," message to the JCP Gateway and all connected JOSP Services with at least the STATE access level on current object. "),(0,a.kt)("p",null,"The ",(0,a.kt)("inlineCode",{parentName:"p"},"UPD_MSG")," contains following additional fields:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"compPath: the pillar's path to identify which pillar in the object's structure update his value"),(0,a.kt)("li",{parentName:"ul"},"cmdType: the pillar's type"),(0,a.kt)("li",{parentName:"ul"},"payload: the rest of the message depends on pillar type and the value updated")),(0,a.kt)("p",null,"Update state messages are sent only to JOSP Services that have at least the STATUS access level on current object."),(0,a.kt)("hr",null),(0,a.kt)("h2",{id:"action-request"},"Action Request"),(0,a.kt)("p",null,"SRV > OBJ"),(0,a.kt)("p",null,"JOSP Services can send request to object to execute command exposed as Actions.",(0,a.kt)("br",null)),(0,a.kt)("p",null,"The ",(0,a.kt)("inlineCode",{parentName:"p"},"CMD_MSG")," request can be used to request the execution of any Action Pillar type."),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"fullSrvId: the full service's id contains the service id, the current service's user id and the service instance number"),(0,a.kt)("li",{parentName:"ul"},"objId: target object's id"),(0,a.kt)("li",{parentName:"ul"},"compPath: target pillar's path"),(0,a.kt)("li",{parentName:"ul"},"cmdType: the pillar's type"),(0,a.kt)("li",{parentName:"ul"},"payload: the rest of the message depends on pillar type and the action to execute")),(0,a.kt)("p",null,"When a JOSP Object receive an action request message, it checks the service permission (on current object) and, execute the action only if the service/user pair have at least the ACTION access level."),(0,a.kt)("hr",null),(0,a.kt)("h2",{id:"object-setters"},"Object Setters"),(0,a.kt)("p",null,"SRV > OBJ"),(0,a.kt)("p",null,"JOSP Services can also configure some object's configs: object's name and owner."),(0,a.kt)("p",null,"To update those configs, services send one of the following messages to the object to config:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},(0,a.kt)("inlineCode",{parentName:"p"},"OBJ_SETNAME_MSG")," a message to update object's name")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},(0,a.kt)("inlineCode",{parentName:"p"},"OBJ_SETOWNERID_MSG")," a message to update object's owner")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},"fullSrvId: the full service's id contains the service id, the current service's user id and the service instance number")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},"objId: target object's id")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},"objName: the new name for the target object (only for ",(0,a.kt)("inlineCode",{parentName:"p"},"OBJ_SETNAME_MSG"),")")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},"ownerId: the user id of the new owner for the target object (only for ",(0,a.kt)("inlineCode",{parentName:"p"},"OBJ_SETOWNERID_MSG"),")"))),(0,a.kt)("admonition",{type:"caution"},(0,a.kt)("p",{parentName:"admonition"},"Each time a JOSP Object update his owner, the object disconnect from all JOSP Service (and JCP Gateway), regenerate his object's id and then restart local and cloud connection.")),(0,a.kt)("p",null,"To edit JOSP Object's configs, service/user pair must have at least OWNER access level on that object."),(0,a.kt)("hr",null),(0,a.kt)("h2",{id:"object-permissions-editing"},"Object Permissions Editing"),(0,a.kt)("p",null,"SRV > OBJ"),(0,a.kt)("p",null,"JOSP Services can edit object's permissions remotely using one of the following messages:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"OBJ_ADDPERM_MSG")," a message to add a new permission to the object",(0,a.kt)("ul",{parentName:"li"},(0,a.kt)("li",{parentName:"ul"},"fullSrvId: the full service's id contains the service id, the current service's user id and the service instance number"),(0,a.kt)("li",{parentName:"ul"},"objId: target object's id"),(0,a.kt)("li",{parentName:"ul"},"srvId: the new permission's service id"),(0,a.kt)("li",{parentName:"ul"},"usrId: the new permission's user id"),(0,a.kt)("li",{parentName:"ul"},"permType: the new permission's access level"),(0,a.kt)("li",{parentName:"ul"},"connType: the new permission's connection type"))),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"OBJ_UPDPERM_MSG")," a message to update an existing permission to the object",(0,a.kt)("ul",{parentName:"li"},(0,a.kt)("li",{parentName:"ul"},"fullSrvId: the full service's id contains the service id, the current service's user id and the service instance number"),(0,a.kt)("li",{parentName:"ul"},"objId: target object's id"),(0,a.kt)("li",{parentName:"ul"},"permId: target object's id"),(0,a.kt)("li",{parentName:"ul"},"srvId: the updated permission's service id"),(0,a.kt)("li",{parentName:"ul"},"usrId: the updated permission's user id"),(0,a.kt)("li",{parentName:"ul"},"permType: the updated permission's access level"),(0,a.kt)("li",{parentName:"ul"},"connType: the updated permission's connection type"))),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"OBJ_REMPERM_MSG")," a message to remove an existing permission to the object",(0,a.kt)("ul",{parentName:"li"},(0,a.kt)("li",{parentName:"ul"},"fullSrvId: the full service's id contains the service id, the current service's user id and the service instance number"),(0,a.kt)("li",{parentName:"ul"},"objId: target object's id"),(0,a.kt)("li",{parentName:"ul"},"permId: target object's id")))),(0,a.kt)("p",null,"To edit JOSP Object's permissions, service/user pair must have at least OWNER access level on that object."),(0,a.kt)("hr",null),(0,a.kt)("h2",{id:"object-history-requests"},"Object History Requests"),(0,a.kt)("p",null,"SRV > OBJ"),(0,a.kt)("p",null,"JOSP Services can also access to object's history."),(0,a.kt)("p",null,"JOSP Objects store all statuses values and all internal events, so services can request both via following messages."),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"H_EVENTS_MSG"),(0,a.kt)("ul",{parentName:"li"},(0,a.kt)("li",{parentName:"ul"},"fullSrvId: the full service's id contains the service id, the current service's user id and the service instance number"),(0,a.kt)("li",{parentName:"ul"},"objId: target object's id"),(0,a.kt)("li",{parentName:"ul"},"reqId: request's id, used to pair requests and responses"),(0,a.kt)("li",{parentName:"ul"},"limits: HistoryLimits objects to define request's time or quantity limits"),(0,a.kt)("li",{parentName:"ul"},"evType: request's filter on events type"))),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"H_STATUS_MSG"),(0,a.kt)("ul",{parentName:"li"},(0,a.kt)("li",{parentName:"ul"},"fullSrvId: the full service's id contains the service id, the current service's user id and the service instance number"),(0,a.kt)("li",{parentName:"ul"},"objId: target object's id"),(0,a.kt)("li",{parentName:"ul"},"compPath: required pillar's path"),(0,a.kt)("li",{parentName:"ul"},"reqId: request's id, used to pair requests and responses"),(0,a.kt)("li",{parentName:"ul"},"limits: HistoryLimits objects to define request's time or quantity limits")))),(0,a.kt)("hr",null),(0,a.kt)("h2",{id:"jcp-gateway-messages"},"JCP Gateway messages"),(0,a.kt)("p",null,"JCP GW > SRV"),(0,a.kt)("p",null,"When a JOSP Service connect to the JCP Gateway, it sent to the connected services all available objects (also objects actually not connected)."),(0,a.kt)("p",null,"The Gateway informs connected services that an object is not connected with the ",(0,a.kt)("inlineCode",{parentName:"p"},"OBJ_DISCONNECT_MSG")," message.\nThis message contains only the object's id (",(0,a.kt)("inlineCode",{parentName:"p"},"objId"),") that is not connected to the Gateway."))}m.isMDXComponent=!0},26113:(e,t,s)=>{s.d(t,{ZP:()=>r});var n=s(87462),a=(s(67294),s(3905)),i=s(41181);const l={toc:[]},o="wrapper";function r(e){let{components:t,...s}=e;return(0,a.kt)(o,(0,n.Z)({},l,s,{components:t,mdxType:"MDXLayout"}),(0,a.kt)(i.ZP,{container:!0,spacing:4,mdxType:"Grid"},(0,a.kt)(i.ZP,{item:!0,xs:2,mdxType:"Grid"},(0,a.kt)("img",{src:s.logo_path,width:"200"})),(0,a.kt)(i.ZP,{item:!0,xs:10,mdxType:"Grid"},(0,a.kt)("div",null,s.children))))}r.isMDXComponent=!0}}]);