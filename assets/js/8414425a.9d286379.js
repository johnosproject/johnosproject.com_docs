"use strict";(self.webpackChunkjosp_docs=self.webpackChunkjosp_docs||[]).push([[9653],{3905:(e,t,r)=>{r.d(t,{Zo:()=>u,kt:()=>m});var a=r(67294);function o(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function n(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function l(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?n(Object(r),!0).forEach((function(t){o(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):n(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function i(e,t){if(null==e)return{};var r,a,o=function(e,t){if(null==e)return{};var r,a,o={},n=Object.keys(e);for(a=0;a<n.length;a++)r=n[a],t.indexOf(r)>=0||(o[r]=e[r]);return o}(e,t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);for(a=0;a<n.length;a++)r=n[a],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}var s=a.createContext({}),p=function(e){var t=a.useContext(s),r=t;return e&&(r="function"==typeof e?e(t):l(l({},t),e)),r},u=function(e){var t=p(e.components);return a.createElement(s.Provider,{value:t},e.children)},c="mdxType",h={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},d=a.forwardRef((function(e,t){var r=e.components,o=e.mdxType,n=e.originalType,s=e.parentName,u=i(e,["components","mdxType","originalType","parentName"]),c=p(r),d=o,m=c["".concat(s,".").concat(d)]||c[d]||h[d]||n;return r?a.createElement(m,l(l({ref:t},u),{},{components:r})):a.createElement(m,l({ref:t},u))}));function m(e,t){var r=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var n=r.length,l=new Array(n);l[0]=d;var i={};for(var s in t)hasOwnProperty.call(t,s)&&(i[s]=t[s]);i.originalType=e,i[c]="string"==typeof e?e:o,l[1]=i;for(var p=2;p<n;p++)l[p]=r[p];return a.createElement.apply(null,l)}return a.createElement.apply(null,r)}d.displayName="MDXCreateElement"},65033:(e,t,r)=>{r.r(t),r.d(t,{assets:()=>s,contentTitle:()=>l,default:()=>h,frontMatter:()=>n,metadata:()=>i,toc:()=>p});var a=r(87462),o=(r(67294),r(3905));const n={title:"Executor Http"},l="JOD Worker Executor Http",i={unversionedId:"jod/specs/workers/executor_http",id:"jod/specs/workers/executor_http",title:"Executor Http",description:"When an action must be executed, this executor performs a HTTP Request defined via HTTP Request configs.",source:"@site/3_references/1_josp/1_jod/4_specs/6_workers/executor_http.mdx",sourceDirName:"1_jod/4_specs/6_workers",slug:"/jod/specs/workers/executor_http",permalink:"/references/josp/jod/specs/workers/executor_http",draft:!1,tags:[],version:"current",frontMatter:{title:"Executor Http"},sidebar:"referencesSidebar",previous:{title:"Executor File",permalink:"/references/josp/jod/specs/workers/executor_file"},next:{title:"Executor Shell",permalink:"/references/josp/jod/specs/workers/executor_shell"}},s={},p=[{value:"Firmware Configs - Executor",id:"firmware-configs---executor",level:2},{value:"<code>requestBody</code>",id:"requestbody",level:3},{value:"Firmware Configs - Http request",id:"firmware-configs---http-request",level:2},{value:"<code>requestUrl</code>",id:"requesturl",level:3},{value:"<code>requestVerb</code>",id:"requestverb",level:3},{value:"<code>requestTimeOut</code>",id:"requesttimeout",level:3},{value:"<code>requestIgnoreSSLHosts</code>",id:"requestignoresslhosts",level:3},{value:"<code>availabilityRetrySeconds</code>",id:"availabilityretryseconds",level:3},{value:"Examples",id:"examples",level:2}],u={toc:p},c="wrapper";function h(e){let{components:t,...r}=e;return(0,o.kt)(c,(0,a.Z)({},u,r,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("h1",{id:"jod-worker-executor-http"},"JOD Worker Executor Http"),(0,o.kt)("p",null,"When an ",(0,o.kt)("a",{parentName:"p",href:"../pillars#action"},"action")," must be executed, this executor performs a HTTP Request defined via ",(0,o.kt)("a",{parentName:"p",href:"#firmware-configs---http-request"},"HTTP Request")," configs."),(0,o.kt)("p",null,"Before execute the request, the ",(0,o.kt)("inlineCode",{parentName:"p"},"requestUrl")," and the ",(0,o.kt)("inlineCode",{parentName:"p"},"requestBody")," strings are updated and all their placeholder are replaced with current ",(0,o.kt)("a",{parentName:"p",href:"workers_placeholders#pillar"},"Pillar"),", ",(0,o.kt)("a",{parentName:"p",href:"workers_placeholders#state"},"State")," and ",(0,o.kt)("a",{parentName:"p",href:"workers_placeholders#action"},"Action")," properties.",(0,o.kt)("br",null),"\nAfter that execute the HTTP Request with updated url and body."),(0,o.kt)("hr",null),(0,o.kt)("h2",{id:"firmware-configs---executor"},"Firmware Configs - Executor"),(0,o.kt)("h3",{id:"requestbody"},(0,o.kt)("inlineCode",{parentName:"h3"},"requestBody")),(0,o.kt)("p",null,"String format used to generate the HTTP Request body. Default value ''."),(0,o.kt)("p",null,"This string can contains ",(0,o.kt)("a",{parentName:"p",href:"workers_placeholders#pillar"},"Pillar's"),", ",(0,o.kt)("a",{parentName:"p",href:"workers_placeholders#state"},"State's")," and ",(0,o.kt)("a",{parentName:"p",href:"workers_placeholders#action"},"Action's Placeholder")," that will be replaced before executing the HTTP Request."),(0,o.kt)("p",null,"This property is updated with ",(0,o.kt)("a",{parentName:"p",href:"workers_placeholders#pillar"},"Pillar's Placeholder")," on worker initialization and with ",(0,o.kt)("a",{parentName:"p",href:"workers_placeholders#state"},"State Placeholder")," and ",(0,o.kt)("a",{parentName:"p",href:"workers_placeholders#state"},"Action Placeholder")," on executing action."),(0,o.kt)("hr",null),(0,o.kt)("h2",{id:"firmware-configs---http-request"},"Firmware Configs - Http request"),(0,o.kt)("p",null,"HTTP Requests are performed using the ",(0,o.kt)("a",{parentName:"p",href:"https://bitbucket.org/johnosproject_shared/com.robypomper.josp/src/2.2.1/src/jospCommons/java/com/robypomper/josp/clients/DefaultHTTPClient.java"},"DefaultHTTPClient")," from the ",(0,o.kt)("a",{parentName:"p",href:"http://localhost:3000/docs/references/josp/internal/josp_commons/"},"JOSP Commons")," library."),(0,o.kt)("p",null,"Following Firmware Configs allow you customize the request that must be perform on worker execution.",(0,o.kt)("br",null),"\nThose configs are defined and used by ",(0,o.kt)("a",{parentName:"p",href:"https://bitbucket.org/johnosproject_shared/com.robypomper.josp/src/2.2.1/src/jospJOD/java/com/robypomper/josp/jod/executor/impls/http/HTTPInternal.java"},"HTTPInternal")," class."),(0,o.kt)("h3",{id:"requesturl"},(0,o.kt)("inlineCode",{parentName:"h3"},"requestUrl")),(0,o.kt)("p",null,"The url used for the HTTP Request. ",(0,o.kt)("strong",{parentName:"p"},"It's mandatory.")),(0,o.kt)("p",null,"This string is used to format the final url for the HTTP Request.",(0,o.kt)("br",null),"\nThe ",(0,o.kt)("inlineCode",{parentName:"p"},"requestUrl")," string is updated during worker initialization and then each time the executor execute an action."),(0,o.kt)("p",null,"This property is updated with ",(0,o.kt)("a",{parentName:"p",href:"workers_placeholders#pillar"},"Pillar's Placeholder")," on worker initialization and with ",(0,o.kt)("a",{parentName:"p",href:"workers_placeholders#state"},"State Placeholder")," on pulling state."),(0,o.kt)("h3",{id:"requestverb"},(0,o.kt)("inlineCode",{parentName:"h3"},"requestVerb")),(0,o.kt)("p",null,"The HTTP method to use for the HTTP Request. Default 'GET'."),(0,o.kt)("p",null,"This string can be one of the following values:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"'GET'"),(0,o.kt)("li",{parentName:"ul"},"'POST'"),(0,o.kt)("li",{parentName:"ul"},"'PUT'"),(0,o.kt)("li",{parentName:"ul"},"'DELETE'"),(0,o.kt)("li",{parentName:"ul"},"'HEAD'"),(0,o.kt)("li",{parentName:"ul"},"'OPTIONS'"),(0,o.kt)("li",{parentName:"ul"},"'TRACE'"),(0,o.kt)("li",{parentName:"ul"},"'PATCH'")),(0,o.kt)("p",null,"Those values are coming from the ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/scribejava/scribejava"},"Scribe Java library"),"."),(0,o.kt)("p",null,"This property is updated with ",(0,o.kt)("a",{parentName:"p",href:"workers_placeholders#pillar"},"Pillar's Placeholder")," on worker initialization."),(0,o.kt)("h3",{id:"requesttimeout"},(0,o.kt)("inlineCode",{parentName:"h3"},"requestTimeOut")),(0,o.kt)("p",null,"The HTTP Request's timeout in seconds. Default '30'."),(0,o.kt)("p",null,"This property is updated with ",(0,o.kt)("a",{parentName:"p",href:"workers_placeholders#pillar"},"Pillar's Placeholder")," on worker initialization."),(0,o.kt)("h3",{id:"requestignoresslhosts"},(0,o.kt)("inlineCode",{parentName:"h3"},"requestIgnoreSSLHosts")),(0,o.kt)("p",null,"Set this string to 'True' to ignore \"SSL: Invalid Hostname\" error. Default 'false'."),(0,o.kt)("p",null,"If the HTTP Server that receive the HTTP Request is set to use the SSL encryption but his certificate or hostname are not valid."),(0,o.kt)("p",null,"This property is updated with ",(0,o.kt)("a",{parentName:"p",href:"workers_placeholders#pillar"},"Pillar's Placeholder")," on worker initialization."),(0,o.kt)("h3",{id:"availabilityretryseconds"},(0,o.kt)("inlineCode",{parentName:"h3"},"availabilityRetrySeconds")),(0,o.kt)("p",null,"When the HTTP Server is not reachable, this property define how much seconds wait before retry contacting the server. Default '10'."),(0,o.kt)("p",null,(0,o.kt)("em",{parentName:"p"},"This property is not used in the Executor HTTP worker execution.")),(0,o.kt)("p",null,"This property is updated with ",(0,o.kt)("a",{parentName:"p",href:"workers_placeholders#pillar"},"Pillar's Placeholder")," on worker initialization."),(0,o.kt)("hr",null),(0,o.kt)("h2",{id:"examples"},"Examples"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-json",metastring:'title="struct.jod: BoolenAction/Http @ JOD Philips Hue"',title:'"struct.jod:',"BoolenAction/Http":!0,"@":!0,JOD:!0,Philips:!0,'Hue"':!0},'"Switch": {\n    "type": "BooleanAction",\n    "puller": "http://requestUrl=\'https://philips-hue-tres.local/api/Xex9YLRxERFf0TliilWFj3LkmjtCd2iGLmQSktYY/lights/1\';requestIgnoreSSLHosts=true;",\n    "executor": "http://requestUrl=\'http://philips-hue-tres.local/api/Xex9YLRxERFf0TliilWFj3LkmjtCd2iGLmQSktYY/lights/1/state\';requestVerb=PUT;requestIgnoreSSLHosts=true;requestBody=\'{\\"on\\":%VAL%}\'"\n}\n')),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-json",metastring:'title="struct.jod: RangeAction/Http @ JOD Philips Hue"',title:'"struct.jod:',"RangeAction/Http":!0,"@":!0,JOD:!0,Philips:!0,'Hue"':!0},'"Brightness": {\n    "type": "RangeAction",\n    "puller": "http://requestUrl=\'https://philips-hue-tres.local/api/Xex9YLRxERFf0TliilWFj3LkmjtCd2iGLmQSktYY/lights/1\';requestIgnoreSSLHosts=true;",\n    "executor": "http://requestUrl=\'http://philips-hue-tres.local/api/Xex9YLRxERFf0TliilWFj3LkmjtCd2iGLmQSktYY/lights/1/state\';requestVerb=PUT;requestIgnoreSSLHosts=true;requestBody=\'{\\"bri\\":%VAL_INT%}\'",\n    "min": "0",\n    "max": "254",\n    "step": "25"\n}\n')))}h.isMDXComponent=!0}}]);