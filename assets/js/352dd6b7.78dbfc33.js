"use strict";(self.webpackChunkjosp_docs=self.webpackChunkjosp_docs||[]).push([[242],{3905:(e,t,n)=>{n.d(t,{Zo:()=>c,kt:()=>h});var r=n(67294);function s(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){s(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function a(e,t){if(null==e)return{};var n,r,s=function(e,t){if(null==e)return{};var n,r,s={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(s[n]=e[n]);return s}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(s[n]=e[n])}return s}var l=r.createContext({}),p=function(e){var t=r.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},c=function(e){var t=p(e.components);return r.createElement(l.Provider,{value:t},e.children)},m="mdxType",d={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},u=r.forwardRef((function(e,t){var n=e.components,s=e.mdxType,i=e.originalType,l=e.parentName,c=a(e,["components","mdxType","originalType","parentName"]),m=p(n),u=s,h=m["".concat(l,".").concat(u)]||m[u]||d[u]||i;return n?r.createElement(h,o(o({ref:t},c),{},{components:n})):r.createElement(h,o({ref:t},c))}));function h(e,t){var n=arguments,s=t&&t.mdxType;if("string"==typeof e||s){var i=n.length,o=new Array(i);o[0]=u;var a={};for(var l in t)hasOwnProperty.call(t,l)&&(a[l]=t[l]);a.originalType=e,a[m]="string"==typeof e?e:s,o[1]=a;for(var p=2;p<i;p++)o[p]=n[p];return r.createElement.apply(null,o)}return r.createElement.apply(null,n)}u.displayName="MDXCreateElement"},14285:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>o,default:()=>d,frontMatter:()=>i,metadata:()=>a,toc:()=>p});var r=n(87462),s=(n(67294),n(3905));const i={title:"Permissions"},o="JOD Permissions",a={unversionedId:"jod/specs/permissions",id:"jod/specs/permissions",title:"Permissions",description:"In the JOSP EcoSystem, permissions are handled by objects. Each object know which JOSP Service and user pair can access to himself.",source:"@site/3_references/1_josp/1_jod/4_specs/3_permissions.mdx",sourceDirName:"1_jod/4_specs",slug:"/jod/specs/permissions",permalink:"/references/josp/jod/specs/permissions",draft:!1,tags:[],version:"current",sidebarPosition:3,frontMatter:{title:"Permissions"},sidebar:"referencesSidebar",previous:{title:"Configs",permalink:"/references/josp/jod/specs/configs"},next:{title:"Structure",permalink:"/references/josp/jod/specs/structure"}},l={},p=[{value:"Edit object&#39;s permissions",id:"edit-objects-permissions",level:2},{value:"Object&#39;s Owner",id:"objects-owner",level:2},{value:"Generation",id:"generation",level:2},{value:"JCP Sync",id:"jcp-sync",level:2}],c={toc:p},m="wrapper";function d(e){let{components:t,...n}=e;return(0,s.kt)(m,(0,r.Z)({},c,n,{components:t,mdxType:"MDXLayout"}),(0,s.kt)("h1",{id:"jod-permissions"},"JOD Permissions"),(0,s.kt)("p",null,"In the JOSP EcoSystem, permissions are handled by objects. ",(0,s.kt)("strong",{parentName:"p"},"Each object know which JOSP Service and user pair can access to himself.")),(0,s.kt)("p",null,"On JOSP Object and JOSP Service 'presentation', the object assign a permission level to the connected service.\nThen the object will check this permission level each time he need to send a status update or when receives a request from the connected service."),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Permission level are an ordered list")," and each level grant to service/user the same permission as the lower levels.",(0,s.kt)("br",null),"\nHere the permission levels list ordered from lower to higher:"),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("a",{parentName:"li",href:"/docs/what/josp/specs/permissions#none"},"NONE"),": list object but can't get object's info or structure"),(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("a",{parentName:"li",href:"/docs/what/josp/specs/permissions#status"},"STATUS"),": read object's structure and contained ",(0,s.kt)("a",{parentName:"li",href:"pillars#states"},"Pillar's states")),(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("a",{parentName:"li",href:"/docs/what/josp/specs/permissions#action"},"ACTION"),": require ",(0,s.kt)("a",{parentName:"li",href:"pillars#actions"},"Pillar's actions")," executions"),(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("a",{parentName:"li",href:"/docs/what/josp/specs/permissions#owner"},"OWNER"),": edit object's name, owner or permissions")),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"JOD Agent assigns a permission level to JOSP Services")," using an internal permission table.\nThis table include a ",(0,s.kt)("strong",{parentName:"p"},"service id, a user id and a level permission"),".\nIf there is no row corresponding to the connecting JOSP Service, then this service receive NONE as permission level.",(0,s.kt)("br",null),"\nOn permissions update, all permission levels assigned to JOSP Services are re-assigned."),(0,s.kt)("p",null,"With the aim to speed up the permissions configuration, the JOD Agent allow use ",(0,s.kt)("strong",{parentName:"p"},"special placeholder as wildcards")," instead real service or user id.\nYou can use those special place holder to assign a permission level to more than one service/user pair.\nFor example to grant a desired permission level to a specific user (set user's id) regardless of the service he is using (set ",(0,s.kt)("inlineCode",{parentName:"p"},"#All"),")."),(0,s.kt)("p",null,"Placeholder for the user's id:"),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("inlineCode",{parentName:"li"},"#Owner"),": correspond if the JOSP Service's user is the same as ",(0,s.kt)("a",{parentName:"li",href:"#objects-owner"},"object's owner")),(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("inlineCode",{parentName:"li"},"#All"),": correspond for any JOSP Service's user id")),(0,s.kt)("p",null,"Placeholder for the user's id:"),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("inlineCode",{parentName:"li"},"#All"),": correspond for any JOSP Service id")),(0,s.kt)("p",null,"To provide a more flexible access control management, ",(0,s.kt)("strong",{parentName:"p"},"permission can specify also a connection type"),": ",(0,s.kt)("inlineCode",{parentName:"p"},"OnlyLocal/LocalAndCloud"),".\nIf 'OnlyLocal' is set, the permission can be applied to a service/user pair only if the JOSP Service is connected via Direct Communication."),(0,s.kt)("p",null,"When objects and services interact via JCP (",(0,s.kt)("a",{parentName:"p",href:"/docs/what/josp/specs/comm#cloud"},"Cloud Communication"),"), the ",(0,s.kt)("a",{parentName:"p",href:"/docs/references/josp/jcp/microservices/gws/"},"JCP Gateway")," caches permissions table for each connected object, then use those tables to route all messages."),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"Permission examples:")),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("inlineCode",{parentName:"li"},"SrvId: #All, UsrId: x-y-z, Type: CoOwner, Conn: LocalAndCloud"),(0,s.kt)("br",null),"\nGrant ",(0,s.kt)("inlineCode",{parentName:"li"},"CoOwner")," permission level to ",(0,s.kt)("inlineCode",{parentName:"li"},"all")," services used by specific ",(0,s.kt)("inlineCode",{parentName:"li"},"x-y-z")," user."),(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("inlineCode",{parentName:"li"},"SrvId: #All, UsrId: #All, Type: Action, Conn: OnlyLocal"),(0,s.kt)("br",null),"\nGrant ",(0,s.kt)("inlineCode",{parentName:"li"},"Action")," permission level to ",(0,s.kt)("inlineCode",{parentName:"li"},"all")," services used by specific ",(0,s.kt)("inlineCode",{parentName:"li"},"any")," user if communicate via Direct Communication."),(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("inlineCode",{parentName:"li"},"SrvId: z-k-j, UsrId: #All, Type: Status, Conn: LocalAndCloud"),(0,s.kt)("br",null),"\nGrant ",(0,s.kt)("inlineCode",{parentName:"li"},"Status")," permission level to ",(0,s.kt)("inlineCode",{parentName:"li"},"any")," user that use the ",(0,s.kt)("inlineCode",{parentName:"li"},"z-k-j")," service.")),(0,s.kt)("hr",null),(0,s.kt)("h2",{id:"edit-objects-permissions"},"Edit object's permissions"),(0,s.kt)("p",null,"JOD Agent allow ",(0,s.kt)("strong",{parentName:"p"},"different ways to add, update or remove object's permission"),"."),(0,s.kt)("p",null,"The most easy way is to use the ",(0,s.kt)("a",{parentName:"p",href:"/docs/references/josp/jcp/microservices/fe"},"JCP FrontEnd")," at ",(0,s.kt)("a",{parentName:"p",href:"https://www.johnosproject.org/frontend"},"www.johnosproject.org/frontend"),".\nAfter you logged in, you can go to the object's Access Control page and update his permissions table."),(0,s.kt)("p",null,"Like the JCP Front End, also many other JOSP Services allow you to edit object's permissions.\nAs long as the service/user pair have the CoOwner permission level on that object."),(0,s.kt)("p",null,"Another way to edit object's permission, used normally on JOSP Object's development, is via the ",(0,s.kt)("a",{parentName:"p",href:"shell"},"JOD Shell"),"'s 'permission' commands."),(0,s.kt)("hr",null),(0,s.kt)("h2",{id:"objects-owner"},"Object's Owner"),(0,s.kt)("p",null,"A permission in a JOSP Object can refer to a user, using the ",(0,s.kt)("inlineCode",{parentName:"p"},"#Owner")," placeholder.\nThis placeholder is replaced with the value contained in the ",(0,s.kt)("inlineCode",{parentName:"p"},"jod.permissions.owner")," property of the ",(0,s.kt)("a",{parentName:"p",href:"configs"},"JOD Agent configs"),"."),(0,s.kt)("p",null,"Because when a user change object's owner, the object update his id, it also invalidates all permissions. That trigger a new permissions generation.\nThis is part of the re-fresh of the JOSP Object when transferred from old owner to a new one."),(0,s.kt)("hr",null),(0,s.kt)("h2",{id:"generation"},"Generation"),(0,s.kt)("p",null,"On JOD Agent startup, if no permission files is present or if it's empty, a new permissions are generated and stored in the file.",(0,s.kt)("br",null),"\nNew permission are also generated on object's owner change."),(0,s.kt)("p",null,"When permission are generated, the JOD Agent try to generate them via JOSP Core /Permissions get method from ",(0,s.kt)("a",{parentName:"p",href:"/docs/references/josp/jcp/microservices/apis"},"JCP APIs"),".\nThis method accepts the 'strategy' param that is read from the ",(0,s.kt)("inlineCode",{parentName:"p"},"jod.permissions.generation_strategy")," property from ",(0,s.kt)("a",{parentName:"p",href:"configs"},"JOD Agent configs"),"."),(0,s.kt)("p",null,"If the JCP is not available, then the JOD Agent generate following permissions locally:"),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("inlineCode",{parentName:"li"},"SrvId: #All, UsrId: #Owner, Type: CoOwner, Conn: LocalAndCloud")),(0,s.kt)("li",{parentName:"ul"},(0,s.kt)("inlineCode",{parentName:"li"},"SrvId: #All, UsrId: #All, Type: CoOwner, Conn: OnlyLocal"))),(0,s.kt)("p",null,"The permissions files by default is placed in the main JOD Agent dir with ",(0,s.kt)("inlineCode",{parentName:"p"},"configs/perms.jod")," name. But it can be changed using the ",(0,s.kt)("inlineCode",{parentName:"p"},"jod.permissions.path")," property from ",(0,s.kt)("a",{parentName:"p",href:"configs"},"JOD Agent configs")),(0,s.kt)("hr",null),(0,s.kt)("h2",{id:"jcp-sync"},"JCP Sync"),(0,s.kt)("p",null,"The JCP keep a backup permissions table for each JOSP object to use it when object is offline."),(0,s.kt)("p",null,"Because object's permission can be updated when object was not connected to JCP, it requires a sync system between object and cloud.",(0,s.kt)("br",null),"\nJOSP Services can edit object's permissions also via ",(0,s.kt)("a",{parentName:"p",href:"/docs/what/josp/specs/comm#direct"},"Direct Communication"),".\nSo when an objects connects again to JCP, it must synchronize the cloud permissions table."))}d.isMDXComponent=!0}}]);